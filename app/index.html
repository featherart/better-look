<!doctype html>
<html lang="en" ng-app="histoApp">
<head>
  <meta charset="utf-8">
  <title>Histogram</title>
  <link rel="stylesheet" href="css/app.css"/>
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open Sans">
  <script src="/lib/d3.v3.js"></script>
</head>
<body>

    <header class="mainHeader">
    <div class="title"><img src="img/acsgraphgrsm.jpg">
    ACS Programming Challenge</div>
    <nav><ul>
      <li class="active"><a href="#/view1">About</a></li>
      <li><a href="#/view1">News</a></li>
      <li><a href="#/view1">Results</a></li>
      <li><a href="#/view1">About US</a></li>
    </ul></nav>
  </header>
    
  <div class="mainContent">
    <div class="content"> 
        <article class="topcontent"> 



          <header>
            <h2><a href="#" rel="bookmark" title="Permalink to this POST TITLE">Node Table</a></h2>
          </header>
          
          <footer>
            <p class="post-info">Table of nodes</p>
          </footer>
          
          <content>
               <table>
                <tr ng-controller="NodeCtrl"> 
                  <th>Node</th>
                  <td ng-repeat="node in nodes | filter: query">{{ node.name }}</td>
                </tr>             
                <tr ng-controller="NodeCtrl"> 
                  <th>Capacity</th>
                  <td ng-repeat="node in nodes | filter: query">{{ node.number }}</td>
                </tr>
                <tr ng-controller="FileCtrl">
                  <th># Files</th>
                  <td ng-repeat="file in files">{{ file.name }}</td>
                </tr>
                <tr ng-controller="FileCtrl">
                  <th>Bytes</th>
                  <td ng-repeat="file in files">{{ file.number }}</td>
                </tr>
                <tr>
                  <th>Full %</th>
                  <td>3</td>
                  <td>3</td>
                  <td>3</td>
                </tr> 
              
              </table>
          </content>
          
        </article>

        <article class="bottomcontent"> 
          <header>
            <h2><a href="#" rel="bookmark" title="Permalink to this POST TITLE">Distribution</a></h2>
          </header>

          <footer>
            <p class="post-info">Table of distribution</p>
          </footer>
          
          <content ng-controller="DistCtrl">
            <table>
              <tr>
                <th>File</th>
                <td ng-repeat="distribution in distributions | filter: query2">{{distribution.name}}</td>
              </tr>
              <tr>
                <th>Node</th>
                <td ng-repeat="distribution in distributions | filter: query2">{{distribution.node}}</td>
              </tr>
            </table>
          </content>
        
        </article>
    </div>
        <aside class="top-sidebar">
          Filter Nodes: <input ng-model="query"><br>
          Filter Distributions: <input ng-model="query2">
        </aside>
        <aside class="middle-sidebar">
          <article>
          <h2>Histogram Goes Here</h2>
      <script type="text/javascript">

      //Width and height
      var w = 600;
      var h = 250;
      
      var dataset = [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13,
              11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];
      
      var xScale = d3.scale.ordinal()
              .domain(d3.range(dataset.length))
              .rangeRoundBands([0, w], 0.05);

      var yScale = d3.scale.linear()
              .domain([0, d3.max(dataset)])
              .range([0, h]);
      
      //Create SVG element
      var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

      //Create bars
      svg.selectAll("rect")
         .data(dataset)
         .enter()
         .append("rect")
         .attr("x", function(d, i) {
            return xScale(i);
         })
         .attr("y", function(d) {
            return h - yScale(d);
         })
         .attr("width", xScale.rangeBand())
         .attr("height", function(d) {
            return yScale(d);
         })
         .attr("fill", function(d) {
          return "rgb(0, 0, " + (d * 10) + ")";
         });

      //Create labels
      svg.selectAll("text")
         .data(dataset)
         .enter()
         .append("text")
         .text(function(d) {
            return d;
         })
         .attr("text-anchor", "middle")
         .attr("x", function(d, i) {
            return xScale(i) + xScale.rangeBand() / 2;
         })
         .attr("y", function(d) {
            return h - yScale(d) + 14;
         })
         .attr("font-family", "sans-serif")
         .attr("font-size", "11px")
         .attr("fill", "white");




      //On click, update with new data      
      d3.select("p")
        .on("click", function() {

          //New values for dataset
          dataset = [ 11, 12, 15, 20, 18, 17, 16, 18, 23, 25,
                5, 10, 13, 19, 21, 25, 22, 18, 15, 13 ];

          //Update all rects
          svg.selectAll("rect")
             .data(dataset)
             .transition()                // <-- This makes it a smooth transition!
             .attr("y", function(d) {
                return h - yScale(d);
             })
             .attr("height", function(d) {
                return yScale(d);
             })
             .attr("fill", function(d) {
              return "rgb(0, 0, " + (d * 10) + ")";
             });

          //Update all labels
          svg.selectAll("text")
             .data(dataset)
             .text(function(d) {
                return d;
             })
             .attr("x", function(d, i) {
                return xScale(i) + xScale.rangeBand() / 2;
             })
             .attr("y", function(d) {
                return h - yScale(d) + 14;
             });
                    
        });

      
    </script>
            </article>
        </aside>        

  </div>
  
  <footer class="mainFooter">
    <p>Copyright &copy; 2014 <a href="http://http://www.lbl.gov/">Lawrence Berkeley National Labs</a></p>
  </footer>

  <!-- In production use:
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
  -->

  <script src="lib/angular/angular.js"></script>
  <script src="lib/angular/angular-route.js"></script>
  <script src="lib/d3/d3.min.js"
  <script src="js/app.js"></script>
  <script src="js/services.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/filters.js"></script>
  <script src="js/directives.js"></script>
</body>
</html>
